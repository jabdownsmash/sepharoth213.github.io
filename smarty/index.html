<html>
   <head >
      <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
      <title >smartr</title>
   </head>
<body>
<h1>smartysaurus</h1>

<br />
<br />
text here
<br />
<form target="uploader_iframe" onsubmit="myFunction();">
<input type="text" id="text">
<br />
<br />

<button onclick="myFunction()">smartify</button>
</form>
<iframe id="uploader_iframe" name="uploader_iframe" style="display: none;"></iframe>

<p id='output'></p>

<script>

results = [];
callbacks = [];
waitingResponse = false;

function smartifyWord(word,wordIndex) {

  callbacks[wordIndex] = function (answer)
  {
    waitingResponse = false;
    var bestResult = word;
    for(answerIndex in answer)
    {
      if(answer[answerIndex].hasOwnProperty('syn'))
      {
        for(synonymIndex in answer[answerIndex]['syn'])
        {
          synonym = answer[answerIndex]['syn'][synonymIndex];
          if(synonym.length > bestResult.length)
          {
            bestResult = synonym;
          }
        }
      }
    }
    results[wordIndex] = bestResult;
    updateResult();
  };

  var url = 'http://words.bighugelabs.com/api/2/305bee1130ca6310d2d3199eb1bbde79/' + word + '/json?callback=callbacks[' + wordIndex + ']';

  var s = document.createElement("script"); 
  s.onError = function() {results.push(word);};

  s.src = url;
  document.getElementsByTagName("head")[0].appendChild(s); 
}

function smartifyCallback(answer) {
}

function updateResult()
{
  var endSentence = '';
  for(resultIndex in results)
  {
    endSentence += results[resultIndex] + ' ';
  }
  document.getElementById("output").innerHTML = endSentence;
}

function myFunction() {
  text = document.getElementById("text").value;
  words = results = text.split(" ");
  for(wordIndex in words)
  {
    trimmedWord = words[wordIndex].replace(/[^\w\s]|_/g, "");
    if(trimmedWord.length > 4)
    {
      smartifyWord(trimmedWord,wordIndex);
    }
  }
  updateResult();
}
</script>
 
</body>
</html>